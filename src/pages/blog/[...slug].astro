---
import { getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
    const posts = await getCollection(
        "blog",
        ({ data }) => data.lang === "en" && !data.draft,
    );
    return posts.map((post) => ({
        params: { slug: post.id.replace("en/", "").replace(".md", "") },
        props: { post },
    }));
}

const { post } = Astro.props;
const { Content } = await render(post);
---

<Layout
    title={`${post.data.title} | Kyoshiro`}
    description={post.data.description}
>
    <main class="bg-gray-900 text-white min-h-screen py-20 px-4">
        <div class="max-w-4xl mx-auto">
            <a
                href="/blog"
                class="text-blue-400 hover:underline mb-8 inline-block"
            >
                ‚Üê Back to Blog
            </a>

            <article>
                <time class="text-gray-400">
                    {post.data.pubDate.toLocaleDateString("en-US")}
                </time>
                <h1 class="text-4xl font-bold mt-2 mb-4">{post.data.title}</h1>

                {
                    post.data.tags && (
                        <div class="flex flex-wrap gap-2 mb-8">
                            {post.data.tags.map((tag) => (
                                <span class="bg-gray-700 text-sm px-2 py-1 rounded">
                                    {tag}
                                </span>
                            ))}
                        </div>
                    )
                }

                <div class="prose prose-invert max-w-none">
                    <Content />
                </div>
            </article>
        </div>
    </main>
</Layout>
